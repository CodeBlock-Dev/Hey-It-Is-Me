
<div class="wizard-step">
    <div class="text-center mb-4">
        <i class="bi bi-check-circle-fill text-success"></i>
        <h2 class="mt-3 mb-3 text-success">Congratulations!</h2>
        <p class="lead text-muted">Your fact page has been created successfully!</p>
    </div>
    
    <div class="completion-card mb-4">
        <div class="card">
            <div class="card-body text-center">
                <div class="page-url-box mb-3">
                    <input type="text" class="form-control form-control-lg" value="@PageUrl" readonly id="pageUrlInput" />
                </div>
                <div class="action-buttons d-flex flex-nowrap gap-2 justify-content-center">
                    <button class="btn btn-primary flex-fill" type="button" @onclick="CopyToClipboard">
                        @if (_isCopied)
                        {
                            <i class="bi bi-check-circle-fill me-2 text-success"></i>
                            <span>Copied!</span>
                        }
                        else
                        {
                            <i class="bi bi-clipboard me-2"></i>
                            <span>Copy URL</span>
                        }
                    </button>
                    <button class="btn btn-warning flex-fill" @onclick="ViewPage">
                        <i class="bi bi-box-arrow-up-right me-2"></i>View Your Page
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="next-steps">
        <h5 class="mb-3">What's Next?</h5>
        <div class="list-group list-group-flush">
            <div class="list-group-item d-flex align-items-center">
                <i class="bi bi-share me-3 text-primary"></i>
                <div>
                    <strong>Share your page</strong>
                    <small class="d-block text-muted">Copy your page URL and add it to your bio on Instagram, Twitter, WhatsApp, TikTok, Telegram, and other social media platforms</small>
                </div>
            </div>
            <div class="list-group-item d-flex align-items-center">
                <i class="bi bi-gear me-3 text-primary"></i>
                <div>
                    <strong>Customize in dashboard</strong>
                    <small class="d-block text-muted">Add more facts, update contacts, or change your images anytime</small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="text-center mt-4">
        <a href="/dashboard" class="btn btn-outline-primary">
            <i class="bi bi-speedometer2 me-2"></i>Go to Dashboard
        </a>
    </div>
</div>

@code {
    [Parameter] public string PageUrl { get; set; } = "";
    [Inject] private IJSRuntime JSRuntime { get; set; } = default!;
    [Inject] private NavigationManager Navigation { get; set; } = default!;
    
    private bool _isCopied = false;
    
    private async Task CopyToClipboard()
    {
        if (string.IsNullOrEmpty(PageUrl))
            return;
            
        try
        {
            var success = await JSRuntime.InvokeAsync<bool>("createPageWizard.copyToClipboard", PageUrl);
            if (success)
            {
                _isCopied = true;
                StateHasChanged();
                // Reset the copied state after 2 seconds
                await Task.Delay(2000);
                _isCopied = false;
                StateHasChanged();
            }
        }
        catch
        {
            // Handle error silently or show a message
        }
    }
    
    private async Task ViewPage()
    {
        if (!string.IsNullOrEmpty(PageUrl))
        {
            await JSRuntime.InvokeVoidAsync("window.open", PageUrl, "_blank");
        }
    }
}
